# Default values for nexo-auth
replicaCount: 1
image:
  repository: ghcr.io/geraldobl58/nexo-auth
  pullPolicy: Always
  tag: "latest"
# Keycloak specific config
command: []
args:
  - start-dev
  - --http-enabled=true
  - --hostname-strict=false
containerPort: 8080

# Management port para health checks (Keycloak 26+)
managementPort: 9000

imagePullSecrets:
  - name: ghcr-secret
nameOverride: ""
fullnameOverride: ""
serviceAccount:
  create: true
  annotations: {}
  name: ""
# CD updates this with commit SHA to force pod restart
podAnnotations:
  app.kubernetes.io/commit: "3d2fbd5"
podSecurityContext: {}
securityContext: {}
service:
  type: ClusterIP
  port: 8080
livenessProbe:
  httpGet:
    path: /health/live
    port: management
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6
readinessProbe:
  httpGet:
    path: /health/ready
    port: management
  initialDelaySeconds: 15
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 6
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: auth.nexo.io
      paths:
        - path: /
          pathType: Prefix
  tls: []
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
nodeSelector: {}
tolerations: []
affinity: {}
podDisruptionBudget:
  enabled: false
  minAvailable: 1
env:
  NODE_ENV: production
# =============================================================================
# PostgreSQL Configuration for Keycloak persistence
# =============================================================================
postgresql:
  enabled: false
  image:
    repository: postgres
    tag: "16-alpine"
    pullPolicy: IfNotPresent
  database: keycloak
  username: keycloak
  password: keycloak123
  persistence:
    enabled: true
    size: 5Gi
    accessMode: ReadWriteOnce
    storageClass: ""
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 256Mi
